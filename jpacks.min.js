!function(r){function e(){function r(r){var e=this;Object.keys(r).forEach(function(n){e[n]=r[n]})}function e(r){u=r}function n(r){if(r instanceof ArrayBuffer)return r;var e=new ArrayBuffer(r.length),n=new Uint8Array(e,0,r.length);return n.set(r),e}function t(e,t,a,i){var o=r.from(e);if(!o)throw new Error('Parameter schema "'+e+'" is unregister.');return t=n(t),a=a||{},i=i||[0],"undefined"==typeof a.littleEndian&&(a.littleEndian=u),o.unpack(t,a,i)}function a(e,n,t,a){var i=r.from(e);if(!i)throw new Error('Parameter schema "'+e+'" is unregister.');return a=a||[],t=t||{},"undefined"==typeof t.littleEndian&&(t.littleEndian=u),i.pack(n,t,a),a}function i(e){function n(e){if("object"==typeof e){if(e instanceof r)return e.schema;var t=new e.constructor;return Object.keys(e).forEach(function(r){t[r]=n(e[r])}),t}return"function"==typeof e?e.schema:e}return JSON.stringify(n(e)||"").replace(/"/g,"")}var o={};r.register=function(e,n){if("undefined"==typeof e)throw new Error('Parameter "name" is undefined.');o[e]=n,r[e]||(r[e]=n)};var f=[function(r){for(var e={},n=r;"string"==typeof n;){if(e[n])return;n=o[n],e[n]=!0}return n}];r.pushPattern=function(r){"function"==typeof r&&f.push(r)},r.from=function(e){if("undefined"!=typeof e){if(e instanceof r)return e;for(var n=-1,t=0;t<f.length;t++)if(n!==t){var a=f[t](e);if(a){if(a instanceof r)return a;e=a,n=t,t=0}}}};var u;return r.setDefaultLittleEndian=e,r.arrayBufferFrom=n,r.unpack=t,r.pack=a,r.stringify=i,r.prototype.toString=function(){return i(this)},r}function n(){function r(r,e){if("undefined"==typeof r)throw new Error('Parameter "itemSchema" is undefined.');var n=function(e){var n,t;if("number"==typeof e)n=r.size*e;else if(t=g.from(e),"number"!==t.namespace)throw new Error('Parameter "count" is not a numeric type.');return new g({unpack:function(a,i,o){var f=e;if(t&&(f=g.unpack(t,a,i,o)),r.array&&i.littleEndian){n=t.size*f;var u=o[0];return o[0]+=n,[].slice.apply(new r.array(a,u,f))}for(var c=[],s=0;f>s;s++)c.push(g.unpack(r,a,i,o));return c},pack:function(a,i,o){var f=e;if(t&&(f=a?a.length:0,g.pack(t,f,i,o)),r.array&&i.littleEndian){n=r.size*f;var u=new ArrayBuffer(n),c=new r.array(u);c.set(a);var s=new Uint8Array(u);[].push.apply(o,s)}for(var p=0;f>p;p++)g.pack(r,a[p],i,o)},schema:"array("+[g.stringify(r),g.stringify(e)]+")",namespace:"array",size:n})};return n.name="array("+r.name+")",1===arguments.length?n:n(e)}function n(e){return r(e,"uint8")}function t(e){return r(e,"uint16")}function a(e){return r(e,"uint32")}function i(r){return g.array("uint8",r)}function o(r){if("object"!=typeof r)throw new Error('Parameter "schemas" must be a object type.');if(r instanceof g)return r;var e=g.stringify(r),n=Object.keys(r);return new g({unpack:function(e,t,a){var i=new r.constructor,o=t.$scope;return t.$scope=i,n.forEach(function(n){i[n]=g.unpack(r[n],e,t,a)}),t.$scope=o,i},pack:function(e,t,a){var i=t.$scope;t.$scope=e,n.forEach(function(n){g.pack(r[n],e[n],t,a)}),t.$scope=i},object:r,schema:"object("+e+")",namespace:"object"})}function f(r,e){if("number"!=typeof r){var n=r;r=e,e=n}if("number"!=typeof r)throw new Error('Parameter "size" must be a numeric type.');if("object"!=typeof e)throw new Error('Parameter "schemas" must be a object type.');if(e instanceof g)throw new Error('Parameter "schemas" cannot be a Schema object.');var t=Object.keys(e);return new g({unpack:function(n,a,i){var o=i[0],f={};return t.forEach(function(r){i[0]=o,f[r]=g.unpack(e[r],n,a,i)}),i[0]+=r,f},pack:function(n,a,i){var o=new ArrayBuffer(r),f=new Uint8Array(o);t.forEach(function(r){var t=[];g.pack(e[r],n[r],a,t),f.set(t)}),[].push.apply(i,f)},size:r,object:e,schema:"union("+g.stringify(r)+")"})}function u(r,e){if(r=g.from(r),!r)throw new Error('Parameter "baseSchema" is undefined.');if("base"!==r.namespace)throw new Error('Parameter "baseSchema" is not a numeric type.');if("object"!=typeof e)throw new Error('Parameter "map" must be a object type.');if(e instanceof Array){var n={};e.forEach(function(r,e){n[r]=e}),e=n}var t=Object.keys(e);return new g({unpack:function(n,a,i){var o,f=g.unpack(r,n,a,i);return t.every(function(r){return e[r]===f?(o=r,!1):!0}),o},pack:function(n,a,i){if(t.every(function(t){return t===n?(g.pack(r,e[t],a,i),!1):!0}))throw new Error('Not find enum "'+n+'".')},map:e,schema:"enum("+[g.stringify(r),g.stringify(e)]+")",namespace:"base"})}function c(r){return String(r).replace(/[\u0080-\u07ff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(192|e>>6,128|63&e)}).replace(/[\u0800-\uffff]/g,function(r){var e=r.charCodeAt(0);return String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e)})}function s(r){return String(r).replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(r){var e=(31&r.charCodeAt(0))<<6|63&r.charCodeAt(1);return String.fromCharCode(e)}).replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(r){var e=(15&r.charCodeAt(0))<<12|(63&r.charCodeAt(1))<<6|63&r.charCodeAt(2);return String.fromCharCode(e)})}function p(r,e){return"undefined"!=typeof Buffer?new Buffer(r,e):c(r).split("").map(function(r){return r.charCodeAt()})}function y(r){var e=g.array(r,"uint8");return new g({unpack:function(r,n,t){var a=g.unpack(e,r,n,t);return"undefined"!=typeof Buffer?new Buffer(a).toString():s(String.fromCharCode.apply(String,a))},pack:function(r,n,t){g.pack(e,p(r),n,t)},namespace:"string",name:"string("+g.stringify(r)+")",size:r})}function m(r){if("object"!=typeof r)throw new Error('Parameter "patterns" must be a object type.');if(r instanceof g)throw new Error('Parameter "patterns" cannot be a Schema object.');if(!(r instanceof Array))throw new Error('Parameter "patterns" must be a array.');var e=function(e){for(var n=0;n<r.length;n++)if(r[n][0]===e)return r[n][1]};return e.schema="cases("+g.stringify(r)+")",e.namespace="cases",e}function h(r,e){if("string"!=typeof r)throw new Error('Parameter "field" must be a string.');if("function"!=typeof e)throw new Error('Parameter "field" must be a function.');return new g({unpack:function(n,t,a){if(!t.$scope)throw new Error("Unpack must running in object.");var i=t.$scope[r];if("undefined"==typeof i)throw new Error('Field "'+r+'" is undefined.');return g.unpack(e(i),n,t,a)},pack:function(n,t,a){var i=t.$scope[r];if("undefined"==typeof i)throw new Error('Field "'+r+'" is undefined.');g.pack(e(i),n,t,a)},schema:"depend("+[r,g.stringify(e)]+")",namespace:"depend"})}function d(r,e){return h(r,g.array(e))}var g=e(),w={int8:{type:"Int8",size:1,alias:["shortint"],array:Int8Array},uint8:{type:"Uint8",size:1,alias:["byte"],array:Uint8Array},int16:{type:"Int16",size:2,alias:["smallint"],array:Int16Array},uint16:{type:"Uint16",size:2,alias:["word"],array:Uint16Array},int32:{type:"Int32",size:4,alias:["longint"],array:Int32Array},uint32:{type:"Uint32",size:4,alias:["longword"],array:Uint32Array},float32:{type:"Float32",size:4,alias:["single"],array:Float32Array},float64:{type:"Float64",size:8,alias:["double"],array:Float64Array}};Object.keys(w).forEach(function(r){var e=w[r],n=new g({unpack:function(r){return function(n,t,a){var i=a[0];a[0]+=e.size;var o;return o=n instanceof DataView?n:new DataView(n),o[r](i,t.littleEndian)}}("get"+e.type),pack:function(r){return function(n,t,a){var i=new ArrayBuffer(e.size),o=new DataView(i),f=new Uint8Array(i);o[r](0,n,t.littleEndian),[].push.apply(a,f)}}("set"+e.type),size:e.size,name:r,namespace:"number",array:e.array});g.register(r,n),(e.alias||[]).forEach(function(r){g.register(r,n)})}),g.register("array",r),g.register("shortArray",n),g.register("smallArray",t),g.register("longArray",a),g.register("bytes",i),g.register("object",o),g.pushPattern(function(r){if("object"==typeof r){if(r instanceof g)return;if(r instanceof Array)return;return o(r)}}),g.register("union",f),g.register("enums",u),g.register("string",y),g.register("shortString",y("uint8")),g.register("smallString",y("uint16")),g.register("longString",y("uint32"));var l=new g({unpack:function(r,e,n){for(var t=new Uint8Array(r,n[0]),a=0;t[a];)a++;var i=g.unpack(g.string(a),r,e,n);return n[0]++,i},pack:function(r,e,n){var t=g.stringBytes(r);g.pack(g.bytes(t.length),t,e,n),g.pack("byte",0,e,n)},namespace:"cstring",schema:"cstring"});return g.register("cstring",l),g.register("pchar",l),g.register("cases",m),g.register("depend",h),g.register("dependArray",d),g}var t=n();t.create=n;var a=t;"function"==typeof define?(define.amd||define.cmd)&&define(function(){return a}):"undefined"!=typeof module&&module.exports?module.exports=a:window[r]=a}("jpacks");